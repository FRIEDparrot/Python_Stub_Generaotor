# Python Stub Generator  
[English](#overview) | [[ç®€ä½“ä¸­æ–‡]](#ä¸­æ–‡æ¦‚è¿°)  

<a id="overview"></a>

## Overview  
A Python script to generate `.pyi` stub files for Python packages/modules. Almost all code (including this README) was generated by AI (Claude 4.0 and GPT).  

**For C++-based Python libraries** (like PyBind11 or petsc4py), this tool solves critical IDE support issues:  
- âŒ Static completion fails in PyCharm  
- âš ï¸ Dynamic completion may crash due to memory access violations  
- ğŸ” Missing type hints for C++ templates/overloads  

### Key Features
- **Recursive stub generation**: Processes modules and submodules
- **Basic type handling**:
    - Extracts available type hints via `__annotations__`
    - Falls back to `Any` for unknown types 
- **Class support**:
    - Handles inheritance (`__bases__`)
    - Skips most magic methods (except `__init__`, `__call__`, etc.)
- **Directory structure**: Creates `__init__.pyi` files in package hierarchy

### Installation & Usage  
```bash
python pyi_generator.py <package_name> [output_dir] [--remove_if_exists]
```

| Argument             | Description                      |
| -------------------- | -------------------------------- |
| `package_name`       | Target package (e.g. `petsc4py`) |
| `output_dir`         | Optional (default: `./stubs`)    |
| `--remove_if_exists` | Clean existing stubs             |

### Workflow  
1. Generate stubs:  
   ```bash
   python pyi_generator.py petsc4py
   ```
2. In PyCharm:  
   `Right-click stubs folder â†’ Mark Directory as â†’ Sources Root`  

3. You may restart Pycharm to make the completion into effective  

<img src="img\Screenshot 2025-06-22 235206.png" alt="IDE Configuration" style="zoom:36%; center" />

 

* Before/After stub generation in PyCharm 

<img src="img\effect.png" alt="effect" style="zoom:33%;" />

> ğŸ’¡ **Recommendation**:  For complex C++ interfaces, the generated stubs may not be completely comprehensive. Manual review of the stub files is advised.



---

<a id="ä¸­æ–‡æ¦‚è¿°"></a>

## ä¸­æ–‡æ¦‚è¿°
Python æ¨¡å—ç±»å‹å­˜æ ¹ç”Ÿæˆå·¥å…·ï¼ˆåŸºäºAIç”Ÿæˆä»£ç ï¼‰ 

é’ˆå¯¹ **C++æ‰©å±•åº“** (å¦‚ PyBind11/petsc4py):  
- âŒ PyCharm é™æ€è¡¥å…¨å®Œå…¨å¤±æ•ˆ  
- âš ï¸ åŠ¨æ€è¡¥å…¨å¯èƒ½å¼•å‘å†…å­˜è®¿é—®å´©æºƒ  
- ğŸ” ç¼ºå¤±æ¨¡æ¿/é‡è½½å‡½æ•°çš„ç±»å‹æç¤º  

### æ ¸å¿ƒåŠŸèƒ½
- **é€’å½’ç”Ÿæˆ**: å¤„ç†æ¨¡å—åŠå­æ¨¡å—
- **åŸºç¡€ç±»å‹å¤„ç†**:
    - ä»`__annotations__`æå–å·²çŸ¥ç±»å‹
    - æœªçŸ¥ç±»å‹é»˜è®¤ä¸º`Any`
- **ç±»æ”¯æŒ**:
    - å¤„ç†ç»§æ‰¿å…³ç³»
    - è·³è¿‡å¤§éƒ¨åˆ†é­”æœ¯æ–¹æ³•
- **ç›®å½•ç»“æ„**: ç”ŸæˆåŒ…ç»“æ„çš„`__init__.pyi`æ–‡ä»¶ 

### ä½¿ç”¨æµç¨‹  
1. ç”Ÿæˆå­˜æ ¹:  
   ```bash
   python pyi_generator.py petsc4py
   ```
2. PyCharmé…ç½®:  
   `å³é”®å­˜æ ¹ç›®å½• â†’ Mark Directory as â†’ Sources Root`  
3. å¯èƒ½éœ€è¦é‡å¯ Pycharm ä½¿ä¹‹ç”Ÿæ•ˆ 

<img src="img\Screenshot 2025-06-22 235206.png" alt="IDE Configuration" style="zoom:36%; center" />

æ·»åŠ å­˜æ ¹å‰å Pycharm ä»£ç è¡¥å…¨æ•ˆæœå¯¹æ¯”

<center><img src="img\effect.png" alt="effect" style="zoom:33%;" /></center>

> ğŸ’¡ **å»ºè®®**: å¯¹å¤æ‚C++æ¥å£ï¼Œå¾€å¾€ç”Ÿæˆçš„ä¸æ˜¯éå¸¸å…¨é¢ï¼Œå¯äººå·¥æ£€æŸ¥ç”Ÿæˆçš„å­˜æ ¹æ–‡ä»¶
